{% extends "main::container.html" %}

{% import "search::help_messages.html" as messages %}

{% block article %}
        <!-- BODY OF THE SEARCH PAGE - 1st row = title. -->
        <form action="" method="get" id="advanced-form">
            {{ form.hidden_tag() }}
            <div class="text-center"><h3><strong>{{ _('Erweiterte Suche') }}</strong> <a tabindex="0" href="{{ url_for('search.r_search_docs') }}" title="{{ _('Zur ausführlichen Dokumentation der erweiterten Suche') }}"><i class="fas fa-question-circle"></i></a></h3></div>
        <!-- 2d row = search entries. -->
            <div class="row justify-content-center">
                <div class="col-auto">
                    <div class="text-center"><strong>{{ form.corpus.label }}</strong></div>
                    <ul class="corpus-ul">
                        <li><input id="all" name="" type="checkbox" value="all" onclick="checkSubCorpora(this, 'under-all')"> {{ _('Alle') }}</li>
                        <ul class="corpus-ul">
                            <li><input class="under-all" id="formulae" name="" type="checkbox" value="formulae" onclick="checkSubCorpora(this, 'under-formulae')"> Formulae</li>
                                <ul class="corpus-ul">
                                {% for choice in categories['formulae_collection']|sort %}
                                    <li><input class="under-formulae under-all" id="{{ choice[0] }}" name="corpus" type="checkbox" value="{{ choice[0] }}"{% if choice[0] in form.data.corpus %} checked=""{% endif %}> {{ choice[1] }}</li>
                                {% endfor %}
                                </ul>
                            <li><input class="under-all" id="chartae" name="" type="checkbox" value="chartae" onclick="checkSubCorpora(this, 'under-chartae')"> Chartae</li>
                                <ul class="corpus-ul">
                                {% for choice in categories['other_collection']|sort %}
                                    <li><input class="under-chartae under-all" id="{{ choice[0] }}" name="corpus" type="checkbox" value="{{ choice[0] }}"{% if choice[0] in form.data.corpus %} checked=""{% endif %}> {{ choice[1] }}</li>
                                {% endfor %}
                                </ul>
                        </ul>
                    </ul>
                </div>
                <div class="col-2">
                    <div class="form-group">
                        <div class="text-center mb-2"><strong>{{ _('Wortsuche') }}</strong><a tabindex="0" type="button" class="btn btn-link px-1" data-container="body" data-toggle="popover" data-html="true" data-placement="right" data-trigger="focus" data-content="{{ messages.wordSearchMessage }}"><i class="fas fa-question-circle" ></i></a></div>
                        <div>
                            {{ form.q(class="form-control my-0", placeholder=form.q.label.text, id="word-search-box", list="word-search-datalist", default=form.q.label.text, autocomplete="off") }}
                            <datalist id="word-search-datalist">
                            </datalist>
                        </div>
                        <p class="mb-0 smallfont"><span title="{{ _('Die Lemmatasuche ist nur bei lateinischen Formeltexten möglich') }}">{{ form.lemma_search() }} <span class="align-top">{{ form.lemma_search.label }}</span></span> <span title="{{ _('Die Reihenfolge der Wörter beibehalten') }}">{{ form.in_order() }} <span class="align-top">{{ form.in_order.label }}</span></span></p>
                    </div>
                    <div class="form-row align-items-center justify-content-center"><div class="text-center"><p class="mb-0">{{ form.fuzziness.label }} <a tabindex="0" type="button" class="btn btn-link px-0" data-container="body" data-toggle="popover" data-html="true" data-placement="right" data-trigger="focus" data-content="{{ messages.fuzzinessMessage }}"><i class="fas fa-question-circle" ></i></a></p><p>{{ form.fuzziness() }}</p></div>
                    </div>
                    <div class="form-row align-items-center justify-content-center"><div class="text-center">{{ form.slop.label }}: 
                        {{ form.slop(min="0") }} {{ _('Wörter') }}<a tabindex="0" type="button" class="btn btn-link px-1" data-container="body" data-toggle="popover" data-html="true" data-placement="right" data-trigger="focus" data-content="{{ messages.searchRadiusMessage }}"><i class="fas fa-question-circle" ></i></a></div>
                    </div>
                    <div class="text-center mb-2"><strong>{{ _('Regestensuche') }}</strong><a tabindex="0" type="button" class="btn btn-link px-1" data-container="body" data-toggle="popover" data-html="true" data-placement="right" data-trigger="focus" data-content="{{ messages.regestSearchMessage }}"><i class="fas fa-question-circle" ></i></a></div>
                    <div>
                        {{ form.regest_q(class="form-control my-0", placeholder=form.regest_q.label.text, id="regest-word-search-box", list="regest-word-search-datalist", default=form.regest_q.label.text, autocomplete="off") }}
                        <datalist id="regest-word-search-datalist">
                        </datalist>
                    </div>
                    <div class="form-group pt-3">
                        <div class="text-center mb-2"><strong>{{ _('Ausstellungsortsuche') }}</strong></div>
                        <div>
                            {{ form.composition_place(class="form-control my-0", id="place-search",  placeholder=form.composition_place.label.text, default=form.composition_place.label.text) }}
                        </div>
                        <div><input id="firstLetter" name="placeSearch" type="checkbox" checked> <span class="smallfont align-top">{{ _("Anfangsbuchstaben") }}<a tabindex="0" type="button" class="btn btn-link px-1 py-0" data-container="body" data-toggle="popover" data-html="true" data-placement="right" data-trigger="focus" data-content="{{ messages.firstLetterPlaceSearchMessage }}"><i class="fas fa-question-circle" ></i></a></span></input></div>
                    </div>
                </div>
                <div class="col-auto date-search">
                    <div class="text-center"><strong>{{ _('Datumssuche') }}</strong><a tabindex="0" type="button" class="btn btn-link px-1" data-container="body" data-toggle="popover" data-html="true" data-placement="right" data-trigger="focus" data-content="{{ messages.dateSearchMessage }}"><i class="fas fa-question-circle" ></i></a></div>
                    <div class="text-center title"><strong>{{ _('Nach einem bestimmten Datum suchen') }}</strong></div>
                    <div class="form-row align-items-center justify-content-center">
                        <div class="form-group">
                            <div class="text-center">{{ form.year.label }}</div>
                            {% if form.year.errors %}
                            {{ form.year(size=4, class="invalid-field form-control") }}
                            {% else %}
                            {{ form.year(size=4, class="form-control") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            <div class="text-center">{{ form.month.label }}</div>
                            {% if form.month.errors %}
                            {{ form.month(class="invalid-field form-control") }}
                            {% else %}
                            {{ form.month(class="form-control") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            <div class="text-center">{{ form.day.label }}</div>
                            {% if form.day.errors %}
                            {{ form.day(size=2, class="invalid-field form-control") }}
                            {% else %}
                            {{ form.day(size=2, class="form-control") }}
                            {% endif %}
                        </div>  
                    </div>
                    <div class="form-row align-items-center justify-content-center"><div class="text-center">{{ form.date_plus_minus.label }}: 
                        {{ form.date_plus_minus(min="0", max="100") }} {{ _('Jahr(e)') }}</div>
                    </div>
                    <div class="text-center title"><strong>{{ _('Nach einer Datumsspanne suchen') }}</strong></div>
                    <div class="text-center">{{ form.exclusive_date_range(class="align-text-top") }} {{ form.exclusive_date_range.label()}}<a tabindex="0" type="button" class="btn btn-link px-1" data-container="body" data-toggle="popover" data-html="true" data-placement="right" data-trigger="focus" data-content="{{ messages.exclusiveDateSearchMessage }}"><i class="fas fa-question-circle" ></i></a></div>
                    
                    <div class="form-row align-items-center justify-content-center">
                        <div class="date-range-label">{{ _('Von') }}</div>
                        <div class="form-group ml-2">
                            <div class="text-center">{{ form.year_start.label }}</div>
                            {% if form.year_start.errors %}
                            {{ form.year_start(size=4, class="invalid-field form-control") }}
                            {% else %}
                            {{ form.year_start(size=4, class="form-control") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            <div class="text-center">{{ form.month_start.label }}</div>
                            {% if form.month_start.errors %}
                            {{ form.month_start(class="invalid-field form-control") }}
                            {% else %}
                            {{ form.month_start(class="form-control") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            <div class="text-center">{{ form.day_start.label }}</div>
                            {% if form.day_start.errors %}
                            {{ form.day(size=2, class="invalid-field form-control") }}
                            {% else %}
                            {{ form.day_start(size=2, class="form-control") }}
                            {% endif %}
                        </div>
                    </div>
                    <div class="form-row align-items-center justify-content-center">
                        <div class="date-range-label">{{ _('Bis') }}</div>
                        <div class="form-group ml-2">
                            <div class="text-center">{{ form.year_end.label }}</div>
                            {% if form.year_end.errors %}
                            {{ form.year_end(size=4, class="invalid-field form-control") }}
                            {% else %}
                            {{ form.year_end(size=4, class="form-control") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            <div class="text-center">{{ form.month_end.label }}</div>
                            {% if form.month_end.errors %}
                            {{ form.month_end(class="invalid-field form-control") }}
                            {% else %}
                            {{ form.month_end(class="form-control") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            <div class="text-center">{{ form.day_end.label }}</div>
                            {% if form.day_end.errors %}
                            {{ form.day_end(size=2, class="invalid-field form-control") }}
                            {% else %}
                            {{ form.day_end(size=2, class="form-control") }}
                            {% endif %}
                        </div>
                    </div>
                    <div class="text-center"><strong>{{ form.special_days.label }}</strong></div>
                    <div class="text-center"><em>{{ _('Bewegliche Kirchenfeste') }}</em></div>
                    <div class="form-row align-items-center justify-content-center" id="holiday-row">
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Easter">{{ _('Ostern') }}</label>
                            <input class="form-check-input" id="Easter" name="special_days" type="checkbox" value="Easter"{% if "Easter" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Pentecost">{{ _('Pfingsten') }}</label>
                            <input class="form-check-input" id="Pentecost" name="special_days" type="checkbox" value="Pentecost"{% if "Pentecost" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Lent">{{ _('Fastenzeit') }}</label>
                            <input class="form-check-input" id="Lent" name="special_days" type="checkbox" value="Lent"{% if "Lent" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                    </div>
                    <div class="text-center"><em>{{ _('Wochentage') }}</em></div>
                    <div class="form-row align-items-center justify-content-center" id="weekday-row">
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Monday">{{ _('Mo') }}</label>
                            <input class="form-check-input" id="Monday" name="special_days" type="checkbox" value="Monday"{% if "Monday" in form.data.special_days %} checked=""{% endif %}> 
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Tuesday">{{ _('Di') }}</label>
                            <input class="form-check-input" id="Tuesday" name="special_days" type="checkbox" value="Tuesday"{% if "Tuesday" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Wednesday">{{ _('Mi') }}</label>
                            <input class="form-check-input" id="Wednesday" name="special_days" type="checkbox" value="Wednesday"{% if "Wednesday" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Easter">{{ _('Do') }}</label>
                            <input class="form-check-input" id="Thursday" name="special_days" type="checkbox" value="Thursday"{% if "Thursday" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Friday">{{ _('Fr') }}</label>
                            <input class="form-check-input" id="Friday" name="special_days" type="checkbox" value="Friday"{% if "Friday" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Saturday">{{ _('Sa') }}</label>
                            <input class="form-check-input" id="Saturday" name="special_days" type="checkbox" value="Saturday"{% if "Saturday" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                        <div class="form-check form-check-inline form-group">
                            <label class="form-check-label" for="Sunday">{{ _('So') }}</label>
                            <input class="form-check-input" id="Sunday" name="special_days" type="checkbox" value="Sunday"{% if "Sunday" in form.data.special_days %} checked=""{% endif %}>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row justify-content-center pt-2">{{ form.submit(size=32, class="btn btn-lg btn-secondary") }}</div>
            <br>
            <div class="row justify-content-center py-0"><a class="btn btn-sm btn-secondary" href="{{ url_for('search.r_advanced_search') }}" role=button>{{ _('Zurücksetzen') }}</a></div>
        </form>
{% endblock %}

{% block additionalscript %}
<script>
    var tags = {{ composition_places|tojson }};
    var datePlusMinusInvalidMessage = "{{ _('Plus-Minus muss zwischen 0 und 100 Jahren liegen') }}";
    var slopInvalidMessage = "{{ _('Der Suchradius muss zwischen 0 und 100 liegen') }}";
</script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
<script src="{{url_for('InstanceNemo.static', filename='js/advanced_search.js')}}"></script>
{% endblock %}
