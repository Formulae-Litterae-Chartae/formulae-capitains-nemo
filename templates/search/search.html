{% extends "main::container.html" %}

{% block article %}
    <article>
    <header>
    <h1>{{ _('Suchergebnisse') }}</h1>
    </header>
    {% if posts|length == 0 %}
    <h4>{{ _("Keine Ergebnisse gefunden für") }} <span class="font-italic">{{ search_string }}</span>.</h4>
    {% endif %}
    <p>
        <table id="results-sort-table" class="table table-sm table-bordered">
            <thead>
                <tr>
                    <th colspan="4">{{ _('Sortieren nach') }}</th>
                </tr>
                <tr>
                    <th colspan="2">{{ _('Name') }}</th>
                    <th colspan="2">{{ _('Datierung') }}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><a href="{{ sort_urls['urn'] }}">{{ _('Auf') }}</a></td>
                    <td><a href="{{ sort_urls['urn_desc'] }}">{{ _('Ab') }}</a></td>
                    <td><a href="{{ sort_urls['min_date_asc'] }}">{{ _('Auf') }}</a></td>
                    <td><a href="{{ sort_urls['min_date_desc'] }}">{{ _('Ab') }}</a></td>
                </tr>
            </tbody>
        </table>
    </p>
    {% for post in posts %}
        <div class="card">
            {% if current_user.project_team or post['id'] in open_texts %}
            <div class="card-header py-0 text-center"><a href="{{ url_for('InstanceNemo.r_multipassage', objectIds=post['id'], subreferences='all', result_sents=post['sents']|join('$')) }}">
                {{ post['info']['title'] }}
            </a>{% if post['info']['date_string'] != ' ' %} ({{ post['info']['date_string'] }}){% endif %}{% if post['info']['comp_ort']  != ' ' %} ({{ post['info']['comp_ort'] }}){% endif %}</div>
            <div class="card-body py-0">
                {% for sent in post['sents'] %}
                <p class="card-text m-0"><small>- {{ sent }}</small></p>
                {% endfor %}
            </div>
            {% else %}
            <div class="card-header py-0 text-center"><a class="disabled" title="{{ _('Dieser Text unterliegt dem Urheberrecht und ist online nicht verfügbar. Bitte konsultieren Sie den Text in der gedruckten Ausgabe.') }}">
                {{ post['info']['title'] }}
            </a>{% if post['info']['date_string'] != ' ' %} ({{ post['info']['date_string'] }}){% endif %}{% if post['info']['comp_ort']  != ' ' %} ({{ post['info']['comp_ort'] }}){% endif %}</div>
            {% endif %}
        </div>
    {% endfor %}
    {% if last_url or first_url %}
    <nav aria-label="Search results pages">
        <ul class="pagination pagination-sm justify-content-center">
            <li class="page-item{{ ' disabled' if not first_url }}">
                <a class="page-link" href="{{ first_url or '#' }}">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item{{ ' disabled' if not prev_url }}">
                <a class="page-link" href="{{ prev_url or '#' }}">
                    <span aria-hidden="true">&lt;</span>
                </a>
            </li>
            {% for p_url in page_urls %}
            {{ '...' if loop.index == 2 and p_url|first != 2 }}
            {{ '...' if loop.last and loop.previtem|first != p_url|first - 1 }}
            <li class="page-item{{ ' active' if p_url|first == current_page }}">
                <a class="page-link" href="{{ p_url|last }}">
                    {{ p_url|first }}
                </a>
            </li>
            {% endfor %}
            <li class="page-item{{ ' disabled' if not next_url }}">
                <a class="page-link" href="{{ next_url or '#' }}">
                    <span aria-hidden="true">&gt;</span>
                </a>
            </li>
            <li class="page-item{{ ' disabled' if not last_url }}">
                <a class="page-link" href="{{ last_url or '#' }}">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
    {% endif %}
    </article>
{% endblock %}
