{
  "query": {
    "bool": {
      "must": [
        {
          "bool": {
            "should": [
              {
                "range": {
                  "dating": {
                    "gte": "0814-10-29",
                    "lte": "0814-11-20"
                  }
                }
              },
              {
                "bool": {
                  "must": [
                    {
                      "nested": {
                        "path": "specific_date",
                        "query": {
                          "range": {
                            "specific_date.year": {
                              "gte": 814,
                              "lte": 814
                            }
                          }
                        }
                      }
                    },
                    {
                      "nested": {
                        "path": "specific_date",
                        "query": {
                          "range": {
                            "specific_date.month": {
                              "gte": 10,
                              "lte": 10
                            }
                          }
                        }
                      }
                    },
                    {
                      "nested": {
                        "path": "specific_date",
                        "query": {
                          "range": {
                            "specific_date.day": {
                              "gte": 29
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              },
              {
                "bool": {
                  "must": [
                    {
                      "nested": {
                        "path": "specific_date",
                        "query": {
                          "range": {
                            "specific_date.year": {
                              "gte": 814,
                              "lte": 814
                            }
                          }
                        }
                      }
                    },
                    {
                      "nested": {
                        "path": "specific_date",
                        "query": {
                          "range": {
                            "specific_date.month": {
                              "gte": 11,
                              "lte": 11
                            }
                          }
                        }
                      }
                    },
                    {
                      "nested": {
                        "path": "specific_date",
                        "query": {
                          "range": {
                            "specific_date.day": {
                              "lte": 20
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              },
              {
                "bool": {
                  "must": [
                    {
                      "nested": {
                        "path": "specific_date",
                        "query": {
                          "range": {
                            "specific_date.year": {
                              "gte": 815,
                              "lte": 813
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  },
  "sort": "urn",
  "from": 0,
  "size": 10,
  "aggs": {
    "range": {
      "date_range": {
        "field": "min_date",
        "format": "yyyy",
        "ranges": [
          {
            "key": "<499",
            "from": "0002",
            "to": "0499"
          },
          {
            "key": "500-599",
            "from": "0500",
            "to": "0599"
          },
          {
            "key": "600-699",
            "from": "0600",
            "to": "0699"
          },
          {
            "key": "700-799",
            "from": "0700",
            "to": "0799"
          },
          {
            "key": "800-899",
            "from": "0800",
            "to": "0899"
          },
          {
            "key": "900-999",
            "from": "0900",
            "to": "0999"
          },
          {
            "key": ">1000",
            "from": "1000"
          }
        ]
      }
    },
    "corpus": {
      "filters": {
        "filters": {
          "Angers": {
            "match": {
              "_type": "andecavensis"
            }
          },
          "Arnulfinger": {
            "match": {
              "_type": "arnulfinger"
            }
          },
          "B\u00fcnden": {
            "match": {
              "_type": "buenden"
            }
          },
          "Freising": {
            "match": {
              "_type": "freising"
            }
          },
          "Fulda (Dronke)": {
            "match": {
              "_type": "fulda_dronke"
            }
          },
          "Fulda (Stengel)": {
            "match": {
              "_type": "fulda_stengel"
            }
          },
          "Hersfeld": {
            "match": {
              "_type": "hersfeld"
            }
          },
          "Luzern": {
            "match": {
              "_type": "luzern"
            }
          },
          "Markulf": {
            "match": {
              "_type": "markulf"
            }
          },
          "Merowinger": {
            "match": {
              "_type": "merowinger1"
            }
          },
          "Mondsee": {
            "match": {
              "_type": "mondsee"
            }
          },
          "Passau": {
            "match": {
              "_type": "passau"
            }
          },
          "R\u00e4tien": {
            "match": {
              "_type": "raetien"
            }
          },
          "Regensburg": {
            "match": {
              "_type": "regensburg"
            }
          },
          "Rheinisch": {
            "match": {
              "_type": "rheinisch"
            }
          },
          "Salzburg": {
            "match": {
              "_type": "salzburg"
            }
          },
          "Sch\u00e4ftlarn": {
            "match": {
              "_type": "schaeftlarn"
            }
          },
          "St. Gallen": {
            "match": {
              "_type": "stgallen"
            }
          },
          "Wei\u00dfenburg": {
            "match": {
              "_type": "weissenburg"
            }
          },
          "Werden": {
            "match": {
              "_type": "werden"
            }
          },
          "Z\u00fcrich": {
            "match": {
              "_type": "zuerich"
            }
          }
        }
      }
    },
    "no_date": {
      "missing": {
        "field": "min_date"
      }
    }
  },
  "highlight": {
    "fields": {
      "text": {
        "fragment_size": 1000
      },
      "regest": {
        "fragment_size": 1000
      }
    },
    "pre_tags": [
      "</small><strong>"
    ],
    "post_tags": [
      "</strong><small>"
    ],
    "encoder": "html"
  }
}